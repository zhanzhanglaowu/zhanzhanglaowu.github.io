<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>è¡¨æƒ…åŒ…åˆ¶ä½œç¥å™¨ - å…è´¹åœ¨çº¿åˆ¶ä½œ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "PingFang SC", "Microsoft YaHei", sans-serif;
        }

        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding-bottom: 2rem;
        }

        /* å¤´éƒ¨æ ·å¼ */
        .header {
            background-color: #ff6740;
            color: #fff;
            padding: 1rem 1.5rem;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 600;
        }

        .header p {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-top: 0.3rem;
        }

        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 1000px;
            margin: 1.5rem auto;
            padding: 0 1rem;
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 768px) {
            .container {
                grid-template-columns: 280px 1fr;
            }
        }

        /* æ“ä½œé¢æ¿ */
        .control-panel {
            background: #fff;
            border-radius: 12px;
            padding: 1.2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .panel-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #ff6740;
            border-bottom: 1px solid #eee;
            padding-bottom: 0.5rem;
        }

        /* ä¸Šä¼ åŒºåŸŸ */
        .upload-area {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 2rem 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 1.5rem;
        }

        .upload-area:hover {
            border-color: #ff6740;
            background-color: #fff8f5;
        }

        .upload-area input {
            display: none;
        }

        .upload-icon {
            font-size: 2rem;
            color: #999;
            margin-bottom: 0.5rem;
        }

        .upload-text {
            color: #666;
            font-size: 0.9rem;
        }

        /* æ“ä½œæŒ‰é’®ç»„ */
        .control-group {
            margin-bottom: 1.5rem;
        }

        .control-group h3 {
            font-size: 0.95rem;
            margin-bottom: 0.8rem;
            color: #555;
        }

        .btn-group {
            display: flex;
            gap: 0.8rem;
            flex-wrap: wrap;
        }

        .control-btn {
            flex: 1;
            min-width: 60px;
            padding: 0.6rem 0;
            background-color: #f8f8f8;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.3rem;
        }

        .control-btn:hover {
            background-color: #ff6740;
            color: #fff;
            border-color: #ff6740;
        }

        .control-btn svg {
            width: 16px;
            height: 16px;
        }

        /* æ¨¡æ¿é€‰æ‹© */
        .template-list {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            margin-top: 0.8rem;
        }

        .template-item {
            border: 2px solid transparent;
            border-radius: 6px;
            overflow: hidden;
            cursor: pointer;
            aspect-ratio: 1/1;
        }

        .template-item.active {
            border-color: #ff6740;
        }

        .template-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        /* å¯¼å‡ºæŒ‰é’® */
        .export-btn {
            width: 100%;
            padding: 0.8rem;
            background-color: #ff6740;
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 1rem;
        }

        .export-btn:hover {
            background-color: #ff451a;
            transform: translateY(-2px);
        }

        /* åˆ¶ä½œç”»å¸ƒ */
        .editor-area {
            background: #fff;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .canvas-container {
            width: 100%;
            max-width: 500px;
            aspect-ratio: 1/1;
            border: 1px solid #eee;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            background-color: #fff;
            touch-action: none; /* ç¦ç”¨é»˜è®¤è§¦å±è¡Œä¸º */
        }

        .bg-template {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }

        .edit-image {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
            cursor: move;
            touch-action: none;
        }

        /* æç¤ºæ–‡æœ¬ */
        .canvas-tip {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 0;
            color: #999;
            font-size: 0.9rem;
            text-align: center;
        }

        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 767px) {
            .control-btn {
                min-width: 45px;
                padding: 0.5rem 0;
                font-size: 0.8rem;
            }

            .canvas-container {
                max-width: 100%;
            }
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: none;
            text-align: center;
            padding: 1rem;
            color: #ff6740;
        }

        .loading.show {
            display: block;
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>è¡¨æƒ…åŒ…åˆ¶ä½œç¥å™¨</h1>
        <p>è‡ªç”±ç¼–è¾‘å›¾ç‰‡ï¼Œåˆ¶ä½œä¸“å±è¡¨æƒ…åŒ…</p>
    </header>

    <div class="container">
        <!-- æ“ä½œé¢æ¿ -->
        <div class="control-panel">
            <h2 class="panel-title">åˆ¶ä½œå·¥å…·</h2>

            <!-- å›¾ç‰‡ä¸Šä¼  -->
            <div class="upload-area" id="uploadArea">
                <input type="file" id="imageUpload" accept="image/jpeg,image/png,image/webp">
                <div class="upload-icon">ğŸ“·</div>
                <div class="upload-text">ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡<br>æ”¯æŒJPG/PNGæ ¼å¼</div>
            </div>

            <!-- æ¨¡æ¿é€‰æ‹© -->
            <div class="control-group">
                <h3>é€‰æ‹©èƒŒæ™¯æ¨¡æ¿</h3>
                <div class="template-list">
                    <div class="template-item active" data-src="">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ3aGl0ZSIvPjwvc3ZnPg==" alt="æ— èƒŒæ™¯">
                    </div>
                    <div class="template-item" data-src="https://picsum.photos/500/500?random=1">
                        <img src="https://picsum.photos/100/100?random=1" alt="æ¨¡æ¿1">
                    </div>
                    <div class="template-item" data-src="https://picsum.photos/500/500?random=2">
                        <img src="https://picsum.photos/100/100?random=2" alt="æ¨¡æ¿2">
                    </div>
                    <div class="template-item" data-src="https://picsum.photos/500/500?random=3">
                        <img src="https://picsum.photos/100/100?random=3" alt="æ¨¡æ¿3">
                    </div>
                    <div class="template-item" data-src="https://picsum.photos/500/500?random=4">
                        <img src="https://picsum.photos/100/100?random=4" alt="æ¨¡æ¿4">
                    </div>
                    <div class="template-item" data-src="https://picsum.photos/500/500?random=5">
                        <img src="https://picsum.photos/100/100?random=5" alt="æ¨¡æ¿5">
                    </div>
                </div>
            </div>

            <!-- æ—‹è½¬æ“ä½œ -->
            <div class="control-group">
                <h3>æ—‹è½¬å›¾ç‰‡</h3>
                <div class="btn-group">
                    <button class="control-btn" id="rotateLeft">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 12a7 7 0 0 1-7 7H6v-2h6a5 5 0 0 0 5-5V6h2v6zm-7-9a7 7 0 0 1 7 7h2V6a9 9 0 0 0-9-9H6v2h6a5 5 0 0 1 5 5v6h-2V6a7 7 0 0 1-7-7z"/>
                        </svg>
                        å·¦æ—‹è½¬
                    </button>
                    <button class="control-btn" id="rotateRight">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 5a7 7 0 0 1 7 7h2a9 9 0 0 0-9-9V5zm0 14a7 7 0 0 1-7-7H3a9 9 0 0 0 9 9v-2zm-7-7a7 7 0 0 1 7-7v-2a9 9 0 0 0-9 9h2zm14 0a7 7 0 0 1-7 7v2a9 9 0 0 0 9-9h-2z"/>
                        </svg>
                        å³æ—‹è½¬
                    </button>
                </div>
            </div>

            <!-- ç¼©æ”¾æ“ä½œ -->
            <div class="control-group">
                <h3>ç¼©æ”¾å›¾ç‰‡</h3>
                <div class="btn-group">
                    <button class="control-btn" id="zoomIn">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                        </svg>
                        æ”¾å¤§
                    </button>
                    <button class="control-btn" id="zoomOut">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 13H5v-2h14v2z"/>
                        </svg>
                        ç¼©å°
                    </button>
                    <button class="control-btn" id="resetSize">
                        <svg viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 5c-4.41 0-8 3.59-8 8s3.59 8 8 8 8-3.59 8-8-3.59-8-8-8zm0 14c-3.31 0-6-2.69-6-6s2.69-6 6-6 6 2.69 6 6-2.69 6-6 6zm-1-9h2v2h-2zm0 4h2v2h-2z"/>
                        </svg>
                        é‡ç½®
                    </button>
                </div>
            </div>

            <!-- å¯¼å‡ºæŒ‰é’® -->
            <button class="export-btn" id="exportBtn">å¯¼å‡ºè¡¨æƒ…åŒ…</button>
        </div>

        <!-- åˆ¶ä½œç”»å¸ƒ -->
        <div class="editor-area">
            <div class="canvas-container" id="canvasContainer">
                <div class="canvas-tip" id="canvasTip">è¯·ä¸Šä¼ å›¾ç‰‡å¼€å§‹åˆ¶ä½œ</div>
                <img class="bg-template" id="bgTemplate" src="" alt="èƒŒæ™¯æ¨¡æ¿" style="display: none;">
                <img class="edit-image" id="editImage" src="" alt="ç¼–è¾‘å›¾ç‰‡" style="display: none;">
            </div>
            <div class="loading" id="loading">æ­£åœ¨å¯¼å‡ºå›¾ç‰‡...</div>
        </div>
    </div>

    <script>
        // æ ¸å¿ƒå˜é‡
        const imageUpload = document.getElementById('imageUpload');
        const uploadArea = document.getElementById('uploadArea');
        const editImage = document.getElementById('editImage');
        const bgTemplate = document.getElementById('bgTemplate');
        const canvasContainer = document.getElementById('canvasContainer');
        const canvasTip = document.getElementById('canvasTip');
        const rotateLeft = document.getElementById('rotateLeft');
        const rotateRight = document.getElementById('rotateRight');
        const zoomIn = document.getElementById('zoomIn');
        const zoomOut = document.getElementById('zoomOut');
        const resetSize = document.getElementById('resetSize');
        const exportBtn = document.getElementById('exportBtn');
        const templateItems = document.querySelectorAll('.template-item');
        const loading = document.getElementById('loading');

        // å›¾ç‰‡çŠ¶æ€ç®¡ç†
        let imageState = {
            rotation: 0,        // æ—‹è½¬è§’åº¦
            scale: 1,           // ç¼©æ”¾æ¯”ä¾‹
            x: 0,               // åç§»X
            y: 0,               // åç§»Y
            startX: 0,          // æ‹–æ‹½èµ·å§‹X
            startY: 0,          // æ‹–æ‹½èµ·å§‹Y
            isDragging: false,  // æ˜¯å¦æ‹–æ‹½ä¸­
            originalWidth: 0,   // åŸå›¾å®½åº¦
            originalHeight: 0,  // åŸå›¾é«˜åº¦
            containerWidth: 0,  // å®¹å™¨å®½åº¦
            containerHeight: 0  // å®¹å™¨é«˜åº¦
        };

        // åˆå§‹åŒ–å®¹å™¨å°ºå¯¸
        function initContainerSize() {
            imageState.containerWidth = canvasContainer.offsetWidth;
            imageState.containerHeight = canvasContainer.offsetHeight;
        }

        // ä¸Šä¼ å›¾ç‰‡å¤„ç†
        uploadArea.addEventListener('click', () => {
            imageUpload.click();
        });

        imageUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;

            // æ ¡éªŒæ–‡ä»¶ç±»å‹
            const validTypes = ['image/jpeg', 'image/png', 'image/webp'];
            if (!validTypes.includes(file.type)) {
                alert('è¯·ä¸Šä¼ JPG/PNG/WebPæ ¼å¼çš„å›¾ç‰‡');
                return;
            }

            // è¯»å–å›¾ç‰‡
            const reader = new FileReader();
            reader.onload = (event) => {
                editImage.src = event.target.result;
                editImage.onload = () => {
                    // åˆå§‹åŒ–å›¾ç‰‡çŠ¶æ€
                    imageState.rotation = 0;
                    imageState.scale = 1;
                    imageState.x = 0;
                    imageState.y = 0;
                    imageState.originalWidth = editImage.naturalWidth;
                    imageState.originalHeight = editImage.naturalHeight;
                    
                    // æ˜¾ç¤ºå›¾ç‰‡ï¼Œéšè—æç¤º
                    canvasTip.style.display = 'none';
                    editImage.style.display = 'block';
                    
                    // åˆå§‹åŒ–å®¹å™¨å°ºå¯¸
                    initContainerSize();
                    
                    // è°ƒæ•´å›¾ç‰‡åˆå§‹å¤§å°ï¼ˆé€‚é…å®¹å™¨ï¼‰
                    adjustImageFitContainer();
                    updateImageTransform();
                };
            };
            reader.readAsDataURL(file);
        });

        // è°ƒæ•´å›¾ç‰‡åˆå§‹å¤§å°é€‚é…å®¹å™¨
        function adjustImageFitContainer() {
            const containerRatio = imageState.containerWidth / imageState.containerHeight;
            const imageRatio = imageState.originalWidth / imageState.originalHeight;

            if (imageRatio > containerRatio) {
                // æŒ‰å®½åº¦é€‚é…
                imageState.scale = imageState.containerWidth * 0.7 / imageState.originalWidth;
            } else {
                // æŒ‰é«˜åº¦é€‚é…
                imageState.scale = imageState.containerHeight * 0.7 / imageState.originalHeight;
            }
        }

        // æ›´æ–°å›¾ç‰‡å˜æ¢ï¼ˆæ—‹è½¬+ç¼©æ”¾+ä½ç§»ï¼‰
        function updateImageTransform() {
            editImage.style.transform = `translate(-50%, -50%) translate(${imageState.x}px, ${imageState.y}px) rotate(${imageState.rotation}deg) scale(${imageState.scale})`;
        }

        // æ—‹è½¬å›¾ç‰‡
        rotateLeft.addEventListener('click', () => {
            if (!editImage.src) return;
            imageState.rotation -= 90;
            updateImageTransform();
        });

        rotateRight.addEventListener('click', () => {
            if (!editImage.src) return;
            imageState.rotation += 90;
            updateImageTransform();
        });

        // ç¼©æ”¾å›¾ç‰‡
        zoomIn.addEventListener('click', () => {
            if (!editImage.src) return;
            imageState.scale = Math.min(imageState.scale + 0.1, 3); // æœ€å¤§ç¼©æ”¾3å€
            updateImageTransform();
        });

        zoomOut.addEventListener('click', () => {
            if (!editImage.src) return;
            imageState.scale = Math.max(imageState.scale - 0.1, 0.1); // æœ€å°ç¼©æ”¾0.1å€
            updateImageTransform();
        });

        // é‡ç½®å›¾ç‰‡å¤§å°å’Œä½ç½®
        resetSize.addEventListener('click', () => {
            if (!editImage.src) return;
            imageState.rotation = 0;
            imageState.x = 0;
            imageState.y = 0;
            adjustImageFitContainer();
            updateImageTransform();
        });

        // æ‹–æ‹½å›¾ç‰‡åŠŸèƒ½
        editImage.addEventListener('mousedown', startDrag);
        editImage.addEventListener('touchstart', startDrag, { passive: false });

        canvasContainer.addEventListener('mousemove', drag);
        canvasContainer.addEventListener('touchmove', drag, { passive: false });

        canvasContainer.addEventListener('mouseup', endDrag);
        canvasContainer.addEventListener('mouseleave', endDrag);
        canvasContainer.addEventListener('touchend', endDrag);

        // å¼€å§‹æ‹–æ‹½
        function startDrag(e) {
            if (!editImage.src) return;
            
            e.preventDefault();
            imageState.isDragging = true;
            
            // å…¼å®¹é¼ æ ‡å’Œè§¦å±
            const clientX = e.type === 'touchstart' ? e.touches[0].clientX : e.clientX;
            const clientY = e.type === 'touchstart' ? e.touches[0].clientY : e.clientY;
            
            // è®¡ç®—ç›¸å¯¹å®¹å™¨çš„åæ ‡
            const rect = canvasContainer.getBoundingClientRect();
            imageState.startX = clientX - rect.left - imageState.x;
            imageState.startY = clientY - rect.top - imageState.y;
        }

        // æ‹–æ‹½ä¸­
        function drag(e) {
            if (!imageState.isDragging || !editImage.src) return;
            
            e.preventDefault();
            const rect = canvasContainer.getBoundingClientRect();
            
            // å…¼å®¹é¼ æ ‡å’Œè§¦å±
            const clientX = e.type === 'touchmove' ? e.touches[0].clientX : e.clientX;
            const clientY = e.type === 'touchmove' ? e.touches[0].clientY : e.clientY;
            
            // è®¡ç®—æ–°çš„åç§»é‡
            imageState.x = clientX - rect.left - imageState.startX;
            imageState.y = clientY - rect.top - imageState.startY;
            
            updateImageTransform();
        }

        // ç»“æŸæ‹–æ‹½
        function endDrag() {
            imageState.isDragging = false;
        }

        // èƒŒæ™¯æ¨¡æ¿é€‰æ‹©
        templateItems.forEach(item => {
            item.addEventListener('click', () => {
                // ç§»é™¤å…¶ä»–activeçŠ¶æ€
                templateItems.forEach(i => i.classList.remove('active'));
                // æ·»åŠ å½“å‰activeçŠ¶æ€
                item.classList.add('active');
                
                const src = item.getAttribute('data-src');
                if (src) {
                    bgTemplate.src = src;
                    bgTemplate.style.display = 'block';
                } else {
                    bgTemplate.src = '';
                    bgTemplate.style.display = 'none';
                }
            });
        });

        // å¯¼å‡ºå›¾ç‰‡åŠŸèƒ½
        exportBtn.addEventListener('click', async () => {
            if (!editImage.src) {
                alert('è¯·å…ˆä¸Šä¼ å›¾ç‰‡ï¼');
                return;
            }

            loading.classList.add('show');
            
            try {
                // åˆ›å»ºcanvas
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // è®¾ç½®canvaså°ºå¯¸ä¸ºå®¹å™¨å°ºå¯¸
                canvas.width = imageState.containerWidth;
                canvas.height = imageState.containerHeight;
                
                // ç»˜åˆ¶èƒŒæ™¯æ¨¡æ¿
                if (bgTemplate.src) {
                    const bgImg = new Image();
                    bgImg.crossOrigin = 'anonymous';
                    await new Promise((resolve) => {
                        bgImg.onload = resolve;
                        bgImg.src = bgTemplate.src;
                    });
                    ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);
                }
                
                // ä¿å­˜å½“å‰ç”»å¸ƒçŠ¶æ€
                ctx.save();
                
                // ç§»åŠ¨ç”»å¸ƒåŸç‚¹åˆ°ä¸­å¿ƒ
                ctx.translate(canvas.width / 2, canvas.height / 2);
                
                // åº”ç”¨æ—‹è½¬å’Œç¼©æ”¾
                ctx.rotate(imageState.rotation * Math.PI / 180);
                ctx.scale(imageState.scale, imageState.scale);
                
                // ç»˜åˆ¶ç¼–è¾‘å›¾ç‰‡ï¼ˆåŠ ä¸Šåç§»ï¼‰
                const editImg = new Image();
                editImg.crossOrigin = 'anonymous';
                await new Promise((resolve) => {
                    editImg.onload = resolve;
                    editImg.src = editImage.src;
                });
                ctx.drawImage(
                    editImg,
                    -editImg.width / 2 + imageState.x / imageState.scale,
                    -editImg.height / 2 + imageState.y / imageState.scale
                );
                
                // æ¢å¤ç”»å¸ƒçŠ¶æ€
                ctx.restore();
                
                // ç”Ÿæˆä¸‹è½½é“¾æ¥
                const link = document.createElement('a');
                link.download = `è¡¨æƒ…åŒ…_${Date.now()}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                loading.classList.remove('show');
                alert('å¯¼å‡ºæˆåŠŸï¼');
            } catch (error) {
                loading.classList.remove('show');
                alert('å¯¼å‡ºå¤±è´¥ï¼š' + error.message);
                console.error('å¯¼å‡ºé”™è¯¯ï¼š', error);
            }
        });

        // çª—å£å¤§å°å˜åŒ–æ—¶é‡æ–°è®¡ç®—å®¹å™¨å°ºå¯¸
        window.addEventListener('resize', () => {
            if (editImage.src) {
                initContainerSize();
                adjustImageFitContainer();
                updateImageTransform();
            }
        });

        // åˆå§‹åŒ–
        initContainerSize();

        // è§¦å±ç¼©æ”¾æ”¯æŒï¼ˆå¯é€‰æ‰©å±•ï¼‰
        let lastDistance = 0;
        canvasContainer.addEventListener('touchstart', (e) => {
            if (e.touches.length === 2) {
                // è®¡ç®—ä¸¤æŒ‡è·ç¦»
                lastDistance = Math.hypot(
                    e.touches[0].clientX - e.touches[1].clientX,
                    e.touches[0].clientY - e.touches[1].clientY
                );
            }
        }, { passive: false });

        canvasContainer.addEventListener('touchmove', (e) => {
            if (e.touches.length === 2 && editImage.src) {
                e.preventDefault();
                // è®¡ç®—æ–°çš„ä¸¤æŒ‡è·ç¦»
                const newDistance = Math.hypot(
                    e.touches[0].clientX - e.touches[1].clientX,
                    e.touches[0].clientY - e.touches[1].clientY
                );
                
                // è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
                const scaleRatio = newDistance / lastDistance;
                imageState.scale = Math.max(Math.min(imageState.scale * scaleRatio, 3), 0.1);
                
                lastDistance = newDistance;
                updateImageTransform();
            }
        }, { passive: false });
    </script>
</body>
</html>